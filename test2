Nat = Data(Y) < Zero : () | Succ : Y > 
SNat = Record(X) { .head : Nat | .tail : X }
Char = Data(Y) < C0 : () | C1 : () | C2 : () | C3 : () | C4 : () | C5 : () | C6 : () | C7 : () | C8 : () | C9 : () | Cspace : () > 
String = Data(X) < ConsString : (Char,X) | Empty : () >

main : String
main  = fibHasta 9

space : String
space = ConsString(Cspace (),Empty ())

fibStr : Nat -> String
fibStr x =  intToString (.head (myfib x))

fibHasta : Nat -> String
fibHasta 0 = fibStr 0
fibHasta (n+1) = concat ( concat (fibHasta n) space ) (fibStr (n+1))

myfib : Nat -> Nat
myfib 0 = fib
myfib (n+1) = .tail (myfib n)

zip : (Nat -> Nat) -> SNat -> SNat -> SNat
.head (zip f x y) = f (.head x) (.head y)
.tail (zip f x y) = zip f (.tail x) (.tail y)

sum : Nat -> Nat -> Nat
sum x 0 = x
sum x (y+1)  = Succ (sum x y)

intToString : Nat -> String
intToString 0 = ConsString (C0 (),Empty ())
intToString 1 = ConsString (C1 (),Empty ())
intToString 2 = ConsString (C2 (),Empty ())
intToString 3 = ConsString (C3 (),Empty ())
intToString 4 = ConsString (C4 (),Empty ())
intToString 5 = ConsString (C5 (),Empty ())
intToString 6 = ConsString (C6 (),Empty ())
intToString 7 = ConsString (C7 (),Empty ())
intToString 8 = ConsString (C8 (),Empty ())
intToString 9 = ConsString (C9 (),Empty ())
intToString ((((((((((n+1)+1)+1)+1)+1)+1)+1)+1)+1)+1) = concat (intToString (div10 ((((((((((n+1)+1)+1)+1)+1)+1)+1)+1)+1)+1))) (intToString (mod10 ((((((((((n+1)+1)+1)+1)+1)+1)+1)+1)+1)+1)))

concat : String -> String -> String
concat (Empty ()) xs = xs
concat (ConsString (x,xs)) ys = ConsString (x, concat xs ys)


mod10 : Nat -> Nat
mod10 0 = 0
mod10 1 = 1
mod10 2 = 2
mod10 3 = 3
mod10 4 = 4
mod10 5 = 5
mod10 6 = 6
mod10 7 = 7
mod10 8 = 8
mod10 9 = 9
mod10 ((((((((((n+1)+1)+1)+1)+1)+1)+1)+1)+1)+1) = mod10 n

div10 : Nat -> Nat
div10 0 = 0
div10 1 = 0
div10 2 = 0
div10 3 = 0
div10 4 = 0
div10 5 = 0
div10 6 = 0
div10 7 = 0
div10 8 = 0
div10 9 = 0
div10 ((((((((((n+1)+1)+1)+1)+1)+1)+1)+1)+1)+1) = (div10 n)+1

fib : SNat
.head fib = 0
.head (.tail fib)  = 1
.tail (.tail fib) = zip sum fib (.tail fib)


